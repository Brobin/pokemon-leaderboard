{% extends "wiki/base.html" %}
{% load staticfiles pokemon_tags %}

{% block title %}{{ article.title }}{% endblock %}

{% block body_content %}
<h1>{{ article.title }}{% if perms.wiki.editor %}<a href="{% url 'wiki-article-edit' article.id %}" class="btn btn-primary" style="float:right;">Edit Article</a>{% endif %}</h1>
<h4><a href="{{ article.topic.url }}">{{ article.topic }}</a></h4>

{% with article.author as editor %}
<p style="margin-bottom:3px;" class="font-italic">Created by {% if editor.trainer %}{{ editor.trainer.name }}{% else %}{{ editor }}{% endif %} on {{ article.latest_edit.created_at|date }}</p>
{% endwith %}

{% with article.latest_edit.editor as editor %}
<p  class="font-italic">Last updated by {% if editor.trainer %}{{ editor.trainer.name }}{% else %}{{ editor }}{% endif %} on {{ article.latest_edit.created_at|date }} at {{ article.latest_edit.created_at|time }}</p>
{% endwith %}

{% for tag in article.tags.all %}<span class="badge" style="padding-right:7px;"><a href="{% url 'wiki-tag' slug=tag.slug %}">{{ tag.name }}</a></span> {% endfor %}
<hr/>
{% if article.pokemon %}
{% with article.pokemon as p %}
<div class="well">
  <div class="row text-center">
    <div class="col-md-2 col-sm-6 text-center">
      <img src="{{ p.image }}"/>
      <p style="margin-bottom:0;margin-top:10px;">Max CP: <b>{{ p.max_cp }}</b></p>
      <p style="margin-bottom:0"><a href="{% url 'pvp-iv' %}?pokemon={{p.name }}">Optimal IV</a></p>
    </div>
    <div class="col-md-2 col-sm-6">
      <hr class="visible-xs">
      <h5>Typing</h5>
      <p><img src="{% static  p.primary_type.image %}" class="type-image"/>{% if p.secondary_type %}<img src="{% static  p.secondary_type.image %}" class="type-image"/>{% endif %}</p>
    </div>
    <div class="col-md-4 col-sm-6">
      <hr class="visible-xs">
      <h5 class="text-danger">Weaknesses</h5>
      {% for type in p.weaknesses %}
      <img src="{% static type.image  %}" class="type-image"/>
      {% endfor %}
    </div>
    <div class="col-md-4 col-sm-6">
      <hr class="visible-xs">
      <h5 class="text-success">Resistances</h5>
      {% for type in p.resistances %}
      <img src="{% static type.image  %}" class="type-image"/>
      {% endfor %}
    </div>
  </div>
</div>
{% endwith %}
{% endif %}

<div class="well">
  {{ article.rendered_content|safe }}
</div>
{% endblock %}
